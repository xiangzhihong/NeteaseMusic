import{N as ae,e as j,_ as ee,b as ue,d as ce,w as ie}from"./base-BQVd69ut.js";import{c as A,C as de,l as k,p as U,k as y,d as te,r as N,A as O,u as T,F as M,P as fe,J as le,x as ve,o as pe,bB as Ee}from"./index-b8DxEvin.js";import{g as ne,E as se}from"./event-3DiSBjGl.js";function me(e){return e==null}const Te=["class","style"],be=/^on[A-Z]/,Ve=(e={})=>{const{excludeListeners:n=!1,excludeKeys:s}=e,o=A(()=>(s?.value||[]).concat(Te)),a=de();return a?A(()=>{var u;return ae(Object.entries((u=a.proxy)==null?void 0:u.$attrs).filter(([f])=>!o.value.includes(f)&&!(n&&be.test(f))))}):A(()=>({}))},q=e=>typeof Element>"u"?!1:e instanceof Element,Fe=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},_e=(e,n)=>{if(!e||!e.focus)return;let s=!1;q(e)&&!Fe(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),s=!0),e.focus(n),q(e)&&s&&e.removeAttribute("tabindex")},I="focus-trap.focus-after-trapped",R="focus-trap.focus-after-released",ye="focus-trap.focusout-prevented",X={cancelable:!0,bubbles:!1},Pe={cancelable:!0,bubbles:!1},J="focusAfterTrapped",W="focusAfterReleased",Le=Symbol("elFocusTrap"),x=y(),P=y(0),K=y(0);let b=0;const oe=e=>{const n=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const a=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||a?NodeFilter.FILTER_SKIP:o.tabIndex>=0||o===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)n.push(s.currentNode);return n},Y=(e,n)=>{for(const s of e)if(!Se(s,n))return s},Se=(e,n)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(n&&e===n)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},he=e=>{const n=oe(e),s=Y(n,e),o=Y(n.reverse(),e);return[s,o]},Ce=e=>e instanceof HTMLInputElement&&"select"in e,v=(e,n)=>{if(e){const s=document.activeElement;_e(e,{preventScroll:!0}),K.value=window.performance.now(),e!==s&&Ce(e)&&n&&e.select()}};function Z(e,n){const s=[...e],o=e.indexOf(n);return o!==-1&&s.splice(o,1),s}const ge=()=>{let e=[];return{push:o=>{const a=e[0];a&&o!==a&&a.pause(),e=Z(e,o),e.unshift(o)},remove:o=>{var a,u;e=Z(e,o),(u=(a=e[0])==null?void 0:a.resume)==null||u.call(a)}}},we=(e,n=!1)=>{const s=document.activeElement;for(const o of e)if(v(o,n),document.activeElement!==s)return},z=ge(),Ae=()=>P.value>K.value,F=()=>{x.value="pointer",P.value=window.performance.now()},G=()=>{x.value="keyboard",P.value=window.performance.now()},Oe=()=>(k(()=>{b===0&&(document.addEventListener("mousedown",F),document.addEventListener("touchstart",F),document.addEventListener("keydown",G)),b++}),U(()=>{b--,b<=0&&(document.removeEventListener("mousedown",F),document.removeEventListener("touchstart",F),document.removeEventListener("keydown",G))}),{focusReason:x,lastUserFocusTimestamp:P,lastAutomatedFocusTimestamp:K}),_=e=>new CustomEvent(ye,{...Pe,detail:e});let p=[];const Q=e=>{ne(e)===se.esc&&p.forEach(s=>s(e))},Ie=e=>{k(()=>{p.length===0&&document.addEventListener("keydown",Q),j&&p.push(e)}),U(()=>{p=p.filter(n=>n!==e),p.length===0&&j&&document.removeEventListener("keydown",Q)})},Re=te({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[J,W,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:n}){const s=y();let o,a;const{focusReason:u}=Oe();Ie(t=>{e.trapped&&!f.paused&&n("release-requested",t)});const f={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},E=t=>{if(!e.loop&&!e.trapped||f.paused)return;const{altKey:r,ctrlKey:c,metaKey:i,currentTarget:d,shiftKey:h}=t,{loop:V}=e,re=ne(t)===se.tab&&!r&&!c&&!i,m=document.activeElement;if(re&&m){const C=d,[g,w]=he(C);if(g&&w){if(!h&&m===w){const l=_({focusReason:u.value});n("focusout-prevented",l),l.defaultPrevented||(t.preventDefault(),V&&v(g,!0))}else if(h&&[g,C].includes(m)){const l=_({focusReason:u.value});n("focusout-prevented",l),l.defaultPrevented||(t.preventDefault(),V&&v(w,!0))}}else if(m===C){const l=_({focusReason:u.value});n("focusout-prevented",l),l.defaultPrevented||t.preventDefault()}}};le(Le,{focusTrapRef:s,onKeydown:E}),O(()=>e.focusTrapEl,t=>{t&&(s.value=t)},{immediate:!0}),O([s],([t],[r])=>{t&&(t.addEventListener("keydown",E),t.addEventListener("focusin",L),t.addEventListener("focusout",S)),r&&(r.removeEventListener("keydown",E),r.removeEventListener("focusin",L),r.removeEventListener("focusout",S))});const D=t=>{n(J,t)},B=t=>n(W,t),L=t=>{const r=T(s);if(!r)return;const c=t.target,i=t.relatedTarget,d=c&&r.contains(c);e.trapped||i&&r.contains(i)||(o=i),d&&n("focusin",t),!f.paused&&e.trapped&&(d?a=c:v(a,!0))},S=t=>{const r=T(s);if(!(f.paused||!r))if(e.trapped){const c=t.relatedTarget;!me(c)&&!r.contains(c)&&setTimeout(()=>{if(!f.paused&&e.trapped){const i=_({focusReason:u.value});n("focusout-prevented",i),i.defaultPrevented||v(a,!0)}},0)}else{const c=t.target;c&&r.contains(c)||n("focusout",t)}};async function $(){await M();const t=T(s);if(t){z.push(f);const r=t.contains(document.activeElement)?o:document.activeElement;if(o=r,!t.contains(r)){const i=new Event(I,X);t.addEventListener(I,D),t.dispatchEvent(i),i.defaultPrevented||M(()=>{let d=e.focusStartEl;fe(d)||(v(d),document.activeElement!==d&&(d="first")),d==="first"&&we(oe(t),!0),(document.activeElement===r||d==="container")&&v(t)})}}}function H(){const t=T(s);if(t){t.removeEventListener(I,D);const r=new CustomEvent(R,{...X,detail:{focusReason:u.value}});t.addEventListener(R,B),t.dispatchEvent(r),!r.defaultPrevented&&(u.value=="keyboard"||!Ae()||t.contains(document.activeElement))&&v(o??document.body),t.removeEventListener(R,B),z.remove(f),o=null,a=null}}return k(()=>{e.trapped&&$(),O(()=>e.trapped,t=>{t?$():H()})}),U(()=>{e.trapped&&H(),s.value&&(s.value.removeEventListener("keydown",E),s.value.removeEventListener("focusin",L),s.value.removeEventListener("focusout",S),s.value=void 0)}),{onKeydown:E}}});function Ne(e,n,s,o,a,u){return N(e.$slots,"default",{handleKeydown:e.onKeydown})}var je=ee(Re,[["render",Ne],["__file","focus-trap.vue"]]);const ke=ue({to:{type:ce([String,Object]),required:!0},disabled:Boolean}),Ue=te({__name:"teleport",props:ke,setup(e){return(n,s)=>n.disabled?N(n.$slots,"default",{key:0}):(pe(),ve(Ee,{key:1,to:n.to},[N(n.$slots,"default")],8,["to"]))}});var xe=ee(Ue,[["__file","teleport.vue"]]);const Me=ie(xe);export{je as E,Le as F,Me as a,Fe as b,_e as f,me as i,ke as t,Ve as u};
