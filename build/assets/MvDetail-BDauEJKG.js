import"./base-BQVd69ut.js";import{E as Q}from"./el-image-viewer-CWb6PQYi.js";import{E as Y}from"./el-select-DTb24hVD.js";import"./el-popper-CZ_bCuQ8.js";import"./el-input-CYgHh7X5.js";import{d as Z,k as i,W as tt,L as et,l as ot,a as r,f as t,b as o,e as V,s as j,w as f,a4 as _,t as u,u as E,b5 as st,v as z,U as B,V as $,h as x,b6 as nt,b7 as at,b8 as lt,b9 as it,ba as ct,bb as mt,X as dt,o as v}from"./index-b8DxEvin.js";import{_ as R,u as rt}from"./CommentList.vue_vue_type_script_setup_true_lang-yVJd0yvV.js";import{_ as ut}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./event-3DiSBjGl.js";import"./index-vyc-TgTO.js";import"./objects-JOKj_S0Y.js";import"./scroll-BvtJi3kH.js";import"./constants-zWIDR2xC.js";import"./index-BvHh02iH.js";import"./strings-DYj8DN6N.js";import"./error-Cpq0EWYd.js";import"./event-BB_Ol6Sd.js";import"./vnode-Bh7OSXng.js";import"./user-KKBVMGEq.js";const vt={class:"py-10"},pt={class:"flex justify-between"},_t={class:"flex-1"},gt={id:"mv-player"},ft=["src"],xt={key:0},ht={class:"flex items-center mt-5"},yt={class:"ml-4"},Ct={class:"text-lg"},wt={class:"mt-8"},Lt={class:"text-xl font-bold"},kt={class:"mt-6 text-xs opacity-60"},bt={class:"ml-6"},Mt={key:1},It={class:"flex items-center mt-5"},St={class:"flex flex-col ml-4"},Ut={class:"mt-8"},Dt={class:"flex mt-6 text-xs opacity-60"},Nt={class:"flex-1 pb-5 ml-4"},Vt={class:"flex justify-between mt-2 text-xs opacity-60"},jt={class:"mt-14 text-2xl font-bold"},Et={class:"text-sm opacity-60"},zt={class:"flex justify-end mt-4"},Bt={key:2,class:"flex justify-end mt-6"},$t={class:"ml-10"},Rt={key:0},Ft=["onClick"],Pt={class:"flex flex-col justify-center ml-4 w-48"},Tt=Z({__name:"MvDetail",setup(At){const F=tt();dt();const d=i(F.params.id),a=et({mvUrlLoading:!0,myDetailLoading:!0,simiMvLoading:!0,reloadLoading:!1,authorInfoLoading:!0,commentLoading:!0}),C=i(100),P=i(20),w=i(1),M=i(""),L=i([]),h=i(),T=i(),g=i(),n=i({}),y=i(""),A=i(!1),I=async(s=+d.value,e=!1)=>{const m=await nt(s);M.value=m.url,a.reloadLoading||(a.mvUrlLoading=!1),e&&(a.reloadLoading=!1)},S=async(s=+d.value)=>{const e=await at(s);console.log(e),L.value=e.mvs,!a.reloadLoading&&(a.simiMvLoading=!1)},U=async(s=+d.value)=>{const e=await lt(s);h.value=e.data,J(e.data.artistId)},J=async s=>{const e=await it(s);g.value=e.artist,console.log(g),!a.reloadLoading&&(a.authorInfoLoading=!1)},k=async(s=+d.value)=>{const e=await ct(s,w.value);n.value=e,C.value=n.value.total,!a.reloadLoading&&(a.commentLoading=!1)},O=async s=>{T.value?.stop(),d.value=JSON.stringify(s),U(),S(),I(),k()},D=s=>{n.value.total+=1,n.value.comments.unshift(s)},N=(s,e)=>{let{index:m,liked:p}=s;e?(n.value.hotComments[m].liked=p,p?n.value.hotComments[m].likedCount+=1:n.value.hotComments[m].likedCount-=1):(n.value.comments[m].liked=p,p?n.value.comments[m].likedCount+=1:n.value.comments[m].likedCount-=1)},W=s=>{w.value=s,k()},X=()=>y.value?rt(()=>{y.value,+d.value,window.$message.success("评论成功")}):window.$message.error("评论不能为空!");return ot(()=>{U(),S(),I(),k()}),(s,e)=>{const m=_("n-spin"),p=_("n-avatar"),b=_("n-ellipsis"),c=_("n-skeleton"),q=_("n-input"),G=_("n-button"),H=Y,K=Q;return v(),r("div",vt,[t("div",pt,[t("div",_t,[e[5]||(e[5]=t("div",{class:"flex items-center mb-5 cursor-pointer"},[t("p",{class:"ml-2 title"}," MV详情 ")],-1)),t("div",gt,[o(m,{show:a.reloadLoading},{default:f(()=>[t("video",{class:"aspect-video w-full",src:M.value,autoplay:"",controls:""},null,8,ft)]),_:1},8,["show"]),a.authorInfoLoading?(v(),r("div",Mt,[t("div",It,[o(c,{width:"70px",height:"75px",circle:""}),t("div",St,[o(c,{text:"",width:"80px"}),o(c,{text:"",width:"600px",class:"mt-2"})])]),t("div",Ut,[o(c,{width:"450px",text:""}),t("div",Dt,[o(c,{width:"100px",text:""}),o(c,{width:"100px",class:"ml-6",text:""})])])])):(v(),r("div",xt,[t("div",ht,[o(p,{"img-props":{crossorigin:"anonymous"},round:"",size:75,src:g.value.picUrl},null,8,["src"]),t("div",yt,[t("p",Ct,u(g.value.name),1),o(b,{class:"max-w-2xl text-xs opacity-60","line-clamp":2},{default:f(()=>[x(u(g.value.briefDesc),1)]),_:1})])]),t("div",wt,[t("p",Lt,u(h.value.name),1),t("div",kt,[t("span",null," 发布："+u(h.value.publishTime),1),t("span",bt," 播放："+u(E(st)(h.value.playCount)),1)])])])),V(t("div",null,[(v(),r(B,null,$(15,l=>t("div",{key:l,class:"flex mt-5"},[o(c,{circle:"",width:"50px",height:"50px"}),t("div",Nt,[o(c,{text:""}),o(c,{text:""}),t("div",Vt,[o(c,{width:"100px"}),o(c,{width:"100px"})])])])),64))],512),[[z,a.commentLoading]]),V(t("div",null,[t("p",jt,[e[3]||(e[3]=x(" 评论 ",-1)),t("span",Et,"("+u(n.value.total)+")",1)]),o(q,{value:y.value,"onUpdate:value":e[0]||(e[0]=l=>y.value=l),maxlength:"140","show-count":!0,class:"mt-5 h-32",type:"textarea"},null,8,["value"]),t("div",zt,[o(G,{loading:A.value,type:"primary",onClick:X},{default:f(()=>[...e[4]||(e[4]=[x(" 评论 ",-1)])]),_:1},8,["loading"])]),o(R,{"resource-id":+d.value,title:"精彩评论",list:n.value.hotComments||[],onUpdateCommentList:D,onUpdateCommentLiked:e[1]||(e[1]=l=>N(l,!0))},null,8,["resource-id","list"]),o(R,{"resource-id":+d.value,"comment-total-num":n.value.total,title:"最新评论",list:n.value.comments||[],onUpdateCommentList:D,onUpdateCommentLiked:e[2]||(e[2]=l=>N(l,!1))},null,8,["resource-id","comment-total-num","list"])],512),[[z,!a.commentLoading]]),C.value>1?(v(),r("div",Bt,[o(H,{background:"",layout:"prev, pager, next","current-page":w.value,"page-size":P.value,total:C.value,onCurrentChange:W},null,8,["current-page","page-size","total"])])):j("",!0)])]),t("div",$t,[e[6]||(e[6]=t("p",{class:"mb-4 title"}," 相关推荐 ",-1)),L.value.length?(v(),r("div",Rt,[(v(!0),r(B,null,$(L.value,l=>(v(),r("div",{key:l.id,class:"flex mt-4",onClick:Jt=>O(l.id)},[o(K,{class:"rounded-lg",style:{width:"180px",height:"90px"},src:l.cover},null,8,["src"]),t("div",Pt,[o(b,null,{default:f(()=>[x(u(l.name),1)]),_:2},1024),o(b,{class:"text-xs opacity-60"},{default:f(()=>[x(" buy "+u(E(mt)(l.artists)),1)]),_:2},1024)])],8,Ft))),128))])):j("",!0)])])])}}}),me=ut(Tt,[["__scopeId","data-v-20a9b626"]]);export{me as default};
